pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
debug=1
angle=.75

function _update()
	if (btn(0)) angle-=.05
	if (btn(1)) angle+=.05
	
	if(angle>1) angle=angle%1
	if(angle<0) angle=angle%1
end

function _draw()
	cls()
	spr(1,40,40)
	spr(2,70,50)

	rotation(0,0)
	rect(60,60,68,68,7)
	if(debug==1)then
		print(angle,5,10,7)
	end
end

function rotation(xos,yos)
	ca,sa=cos(angle),sin(angle)
 scale=1
 
	for x=0,128 do
		for y=0,128 do
   xp=(x*ca+y*sa)
   yp=(-x*sa+y*ca)
			if((xp>=0)and(xp<128)
					and(yp>=0)and(yp<128))then
				col=pget(x,y)
				if(col!=0)	pset(xp+xos,yp+yos,col)
			end
  end
 end
end

function draw_rotation(x,y,angle,pixoffsetx,pixoffsety)
	ca,sa=cos(angle),sin(angle)
	scale=1

	local xp=0
	local yp=0
	for xo=-4,7 do
		for yo=-4,7 do
			xp=((xo*ca+yo*sa)+(4*scale))/scale
			yp=((-xo*sa+yo*ca)+(4*scale))/scale
			if((xp>=0)and(xp<8)
					and(yp>=0)and(yp<8))then
				col=sget(pixoffsetx+xp,pixoffsety+yp)
				if(col!=0)	pset(x+xo,y+yo,col)
			end
		end
	end
end
__gfx__
00000000333b3333111c111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000b3333b3bc1111c1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007003b3333331c11111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770003333b33b1111c11c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700033b3333311c1111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007003b333b331c111c1100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000003333333b1111111c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000333b3333111c111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
